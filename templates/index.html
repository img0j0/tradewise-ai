{% extends "base.html" %}

{% block content %}
<!-- Main Content Sections -->
<div id="dashboard-section" style="display: block;">
    <!-- Welcome Banner -->
    <div class="row mb-3">
        <div class="col-12">
            <div class="welcome-banner compact">
                <div class="welcome-content">
                    <h2 class="welcome-title">Welcome to Your Trading Command Center</h2>
                    <p class="welcome-subtitle">AI-powered insights at your fingertips</p>
                </div>
                <div class="welcome-stats">
                    <div class="welcome-stat">
                        <span class="stat-icon"><i class="fas fa-brain"></i></span>
                        <span class="stat-value" id="ai-accuracy">98%</span>
                        <span class="stat-label">AI Accuracy</span>
                    </div>
                    <div class="welcome-stat">
                        <span class="stat-icon"><i class="fas fa-chart-line"></i></span>
                        <span class="stat-value" id="market-trend">Bullish</span>
                        <span class="stat-label">Market Trend</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Balance and Market Overview Row -->
    <div class="row mb-3">
        <div class="col-md-4">
            <div class="card bg-dark account-balance-card compact">
                <div class="card-body">
                    <h6 class="mb-2"><i class="fas fa-wallet me-2"></i>Account Balance</h6>
                    <div class="balance-display compact">
                        <span class="balance-amount" id="account-balance">$0.00</span>
                        <div class="balance-actions mt-2">
                            <button class="btn btn-sm btn-success" onclick="showDepositModal()">
                                <i class="fas fa-plus"></i> Deposit
                            </button>
                            <button class="btn btn-sm btn-outline-info" onclick="showTransactionHistory()">
                                <i class="fas fa-history"></i> History
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card bg-secondary market-overview-card compact">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="mb-0"><i class="fas fa-globe me-2"></i>Live Market Pulse</h6>
                        <small class="text-muted" id="last-updated">Loading...</small>
                    </div>
                    <div class="row text-center">
                        <div class="col">
                            <div class="stat-card compact">
                                <div class="stat-number text-primary" id="total-stocks">-</div>
                                <div class="stat-label">Stocks</div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="stat-card compact">
                                <div class="stat-number text-success" id="gainers">-</div>
                                <div class="stat-label">Gainers</div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="stat-card compact">
                                <div class="stat-number text-danger" id="losers">-</div>
                                <div class="stat-label">Losers</div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="stat-card compact">
                                <div class="stat-number" id="avg-change">-</div>
                                <div class="stat-label">Avg Change</div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="stat-card compact">
                                <div class="stat-number text-info" id="total-volume">-</div>
                                <div class="stat-label">Volume</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <!-- Performance Summary -->
        <div class="col-lg-4 mb-4">
            <div class="card bg-dark performance-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-trophy me-2"></i>Your Performance</h5>
                </div>
                <div class="card-body">
                    <div class="performance-stats">
                        <div class="stat-row">
                            <span>Total Trades:</span>
                            <span class="text-primary" id="total-trades">0</span>
                        </div>
                        <div class="stat-row">
                            <span>Win Rate:</span>
                            <span class="text-success" id="win-rate">0%</span>
                        </div>
                        <div class="stat-row">
                            <span>Total P&L:</span>
                            <span id="total-pnl">$0.00</span>
                        </div>
                        <div class="stat-row">
                            <span>Realized P&L:</span>
                            <span id="realized-pnl">$0.00</span>
                        </div>
                        <div class="stat-row">
                            <span>Unrealized P&L:</span>
                            <span id="unrealized-pnl">$0.00</span>
                        </div>
                        <div class="stat-row">
                            <span>Avg Confidence:</span>
                            <span class="text-info" id="avg-confidence">0%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Top Movers -->
        <div class="col-lg-8 mb-4">
            <div class="card bg-dark top-movers-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-trending-up me-2"></i>Top Movers</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-success">Top Gainers</h6>
                            <div id="top-gainers">
                                <div class="text-center text-muted">Loading...</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-danger">Top Losers</h6>
                            <div id="top-losers">
                                <div class="text-center text-muted">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Recent Trades and Alerts -->
    <div class="row">
        <div class="col-lg-6 mb-4">
            <div class="card bg-dark recent-trades-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-history me-2"></i>Recent Trades</h5>
                </div>
                <div class="card-body">
                    <div id="recent-trades">
                        <div class="text-center text-muted">No recent trades</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-6 mb-4">
            <div class="card bg-dark active-alerts-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-bell me-2"></i>Active Alerts</h5>
                </div>
                <div class="card-body">
                    <div id="active-alerts">
                        <div class="text-center text-muted">No active alerts</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Stocks Section -->
<div id="stocks-section" style="display: none;">
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-dark stock-filters-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-filter me-2"></i>Stock Filters</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <label for="sector-filter" class="form-label">Sector</label>
                            <select class="form-select" id="sector-filter">
                                <option value="">All Sectors</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="min-price" class="form-label">Min Price</label>
                            <input type="number" class="form-control" id="min-price" placeholder="0.00" step="0.01">
                        </div>
                        <div class="col-md-3">
                            <label for="max-price" class="form-label">Max Price</label>
                            <input type="number" class="form-control" id="max-price" placeholder="1000.00" step="0.01">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">&nbsp;</label>
                            <button class="btn btn-primary d-block w-100" onclick="applyFilters()">
                                <i class="fas fa-search me-1"></i>Apply Filters
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-12">
            <div class="card bg-dark stock-scanner-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-chart-area me-2"></i>Stock Ticker Scanner</h5>
                </div>
                <div class="card-body">
                    <div id="stocks-list">
                        <div class="text-center text-muted">Loading stocks...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Alerts Section -->
<div id="alerts-section" style="display: none;">
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-dark create-alert-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-plus-circle me-2"></i>Create Personalized Alert</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <label for="alert-symbol" class="form-label">Stock Symbol</label>
                            <input type="text" class="form-control" id="alert-symbol" placeholder="e.g., AAPL" style="text-transform: uppercase;">
                        </div>
                        <div class="col-md-3">
                            <label for="alert-type" class="form-label">Alert Type</label>
                            <select class="form-select" id="alert-type">
                                <option value="price_above">Price Above</option>
                                <option value="price_below">Price Below</option>
                                <option value="percent_change">% Change</option>
                                <option value="volume_spike">Volume Spike</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="alert-value" class="form-label">Trigger Value</label>
                            <input type="number" class="form-control" id="alert-value" placeholder="Enter value" step="0.01">
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">&nbsp;</label>
                            <button class="btn btn-primary d-block w-100" onclick="createAlert()">
                                <i class="fas fa-bell me-1"></i>Create Alert
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-12">
            <div class="card bg-dark trading-alerts-card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="fas fa-bell me-2"></i>Active Trading Alerts</h5>
                    <span class="badge bg-primary" id="active-alerts-count">0</span>
                </div>
                <div class="card-body">
                    <div id="alerts-list">
                        <div class="text-center text-muted">Loading alerts...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Portfolio Section -->
<div id="portfolio-section" style="display: none;">
    <div class="row">
        <div class="col-12">
            <div class="card bg-dark portfolio-holdings-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-briefcase me-2"></i>Portfolio Holdings</h5>
                </div>
                <div class="card-body">
                    <div id="portfolio-summary" class="mb-4">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-number text-primary" id="portfolio-value">$0.00</div>
                                    <div class="stat-label">Total Value</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-number text-info" id="portfolio-cost">$0.00</div>
                                    <div class="stat-label">Total Cost</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-number" id="portfolio-pnl">$0.00</div>
                                    <div class="stat-label">P&L</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-number" id="portfolio-pnl-pct">0%</div>
                                    <div class="stat-label">P&L %</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="portfolio-holdings">
                        <div class="text-center text-muted">No holdings found</div>
                    </div>
                    <div class="mt-4">
                        <small class="text-muted">
                            <i class="fas fa-info-circle me-1"></i>
                            Stock prices are updated in real-time. P&L calculations are based on your purchase price.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Advanced Section -->
<div id="advanced-section" style="display: none;">
    <!-- AI-Powered Header -->
    <div class="advanced-header mb-4">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h2 class="mb-0 d-flex align-items-center">
                    <i class="fas fa-microchip me-3 text-primary"></i>
                    AI Command Center
                </h2>
                <p class="text-muted mb-0">Cutting-edge artificial intelligence powering your investment decisions</p>
            </div>
            <div class="col-md-4 text-end">
                <div class="ai-status-indicator">
                    <span class="badge bg-success pulse-animation">
                        <i class="fas fa-robot me-1"></i>AI Systems Active
                    </span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AI Features Grid -->
    <div class="ai-features-grid">
        <!-- Row 1: Main AI Features -->
        <div class="row mb-4">
            <!-- Personalized AI Assistant -->
            <div class="col-lg-6 mb-4">
                <div class="card bg-gradient-ai h-100">
                    <div class="card-header border-0 bg-transparent">
                        <h5 class="mb-0 text-white d-flex align-items-center">
                            <div class="feature-icon-wrapper me-3">
                                <i class="fas fa-user-robot"></i>
                            </div>
                            Personalized AI Assistant
                        </h5>
                        <p class="text-white-50 small mb-0">Your AI learns from every trade you make</p>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 border-end border-secondary">
                                <h6 class="text-info mb-3">
                                    <i class="fas fa-fingerprint me-2"></i>Your Trading DNA
                                </h6>
                                <div id="trading-profile" class="ai-profile-card">
                                    <div class="text-center text-muted">
                                        <i class="fas fa-spinner fa-spin me-2"></i>Analyzing your patterns...
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-outline-light mt-3 w-100" onclick="learnTradingPatterns()">
                                    <i class="fas fa-brain me-2"></i>Learn from My Trades
                                </button>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-success mb-3">
                                    <i class="fas fa-lightbulb me-2"></i>AI Recommendations
                                </h6>
                                <div id="personalized-recommendations" class="ai-recommendations">
                                    <div class="text-center text-muted">
                                        <i class="fas fa-spinner fa-spin me-2"></i>Generating insights...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- AI Strategy Builder -->
            <div class="col-lg-6 mb-4">
                <div class="card bg-gradient-strategy h-100">
                    <div class="card-header border-0 bg-transparent">
                        <h5 class="mb-0 text-white d-flex align-items-center">
                            <div class="feature-icon-wrapper me-3">
                                <i class="fas fa-puzzle-piece"></i>
                            </div>
                            AI Strategy Builder
                        </h5>
                        <p class="text-white-50 small mb-0">Create & optimize trading strategies with AI</p>
                    </div>
                    <div class="card-body">
                        <div class="strategy-builder-interface">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-warning mb-0">
                                    <i class="fas fa-magic me-2"></i>Strategy Workshop
                                </h6>
                                <button class="btn btn-success btn-sm" onclick="showStrategyBuilder()">
                                    <i class="fas fa-plus-circle me-2"></i>Create Strategy
                                </button>
                            </div>
                            
                            <div id="strategy-builder-form" style="display: none;" class="mb-3">
                                <!-- Strategy builder form will be populated here -->
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-info small">Active Strategies</h6>
                                    <div id="user-strategies" class="strategy-list">
                                        <div class="text-center text-muted small">
                                            <i class="fas fa-spinner fa-spin me-2"></i>Loading strategies...
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-success small">Backtest Performance</h6>
                                    <div id="backtest-results" class="backtest-display">
                                        <div class="text-center text-muted small">
                                            <i class="fas fa-chart-area me-2"></i>Select a strategy
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Row 2: AI Intelligence & Analytics -->
        <div class="row mb-4">
            <!-- AI Model Performance -->
            <div class="col-lg-4 mb-4">
                <div class="card bg-gradient-model h-100">
                    <div class="card-header border-0 bg-transparent">
                        <h5 class="mb-0 text-white">
                            <i class="fas fa-brain me-2"></i>AI Model Intelligence
                        </h5>
                    </div>
                    <div class="card-body">
                        <div id="ai-performance-metrics" class="ai-metrics">
                            <div class="metric-item mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="metric-label">Price Prediction</span>
                                    <span class="badge bg-success" id="price-accuracy">-</span>
                                </div>
                                <div class="progress progress-sm mt-1">
                                    <div class="progress-bar bg-success" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="metric-item mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="metric-label">Trend Analysis</span>
                                    <span class="badge bg-info" id="trend-accuracy">-</span>
                                </div>
                                <div class="progress progress-sm mt-1">
                                    <div class="progress-bar bg-info" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="metric-item mb-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="metric-label">Risk Assessment</span>
                                    <span class="badge bg-warning" id="volatility-accuracy">-</span>
                                </div>
                                <div class="progress progress-sm mt-1">
                                    <div class="progress-bar bg-warning" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="metric-label">Data Points</span>
                                    <span class="badge bg-secondary" id="training-samples">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="d-grid gap-2 mt-3">
                            <button class="btn btn-sm btn-success" onclick="trainAIModel()">
                                <i class="fas fa-graduation-cap me-2"></i>Train AI Model
                            </button>
                            <button class="btn btn-sm btn-info" onclick="triggerContinuousLearning()">
                                <i class="fas fa-sync-alt me-2"></i>Learn from Trades
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- AI Market Predictions -->
            <div class="col-lg-4 mb-4">
                <div class="card bg-gradient-predictions h-100">
                    <div class="card-header border-0 bg-transparent">
                        <h5 class="mb-0 text-white">
                            <i class="fas fa-crystal-ball me-2"></i>AI Predictions
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="prediction-interface">
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" id="prediction-symbol" 
                                       placeholder="Enter stock symbol">
                                <button class="btn btn-primary" onclick="getPredictions()">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div id="market-predictions" class="predictions-display">
                                <div class="text-center text-muted">
                                    <i class="fas fa-chart-line me-2"></i>
                                    Enter a symbol for AI analysis
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Portfolio Optimization -->
            <div class="col-lg-4 mb-4">
                <div class="card bg-gradient-optimize h-100">
                    <div class="card-header border-0 bg-transparent">
                        <h5 class="mb-0 text-white">
                            <i class="fas fa-chart-pie me-2"></i>Portfolio Optimizer
                        </h5>
                    </div>
                    <div class="card-body">
                        <div id="portfolio-optimization">
                            <div class="optimization-status mb-3">
                                <div class="text-center">
                                    <i class="fas fa-cogs fa-3x text-white-50 mb-3"></i>
                                    <p class="text-white-50">AI-powered portfolio optimization</p>
                                </div>
                            </div>
                            <div id="optimization-results"></div>
                            <button class="btn btn-primary btn-sm w-100" onclick="runPortfolioOptimization()">
                                <i class="fas fa-magic me-2"></i>Optimize My Portfolio
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        
        <!-- Row 3: Social & Gamification -->
        <div class="row">
            <!-- Achievements -->
            <div class="col-lg-6 mb-4">
                <div class="card bg-dark h-100">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-trophy me-2 text-warning"></i>Achievements & Leaderboard
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-warning">Your Achievements</h6>
                                <div id="achievements-list" class="achievement-grid"></div>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-info">Top Traders</h6>
                                <div id="top-traders-list" class="trader-leaderboard"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Challenges -->
            <div class="col-lg-6 mb-4">
                <div class="card bg-dark h-100">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-flag-checkered me-2 text-success"></i>Active Challenges
                        </h5>
                    </div>
                    <div class="card-body">
                        <div id="challenges-list" class="challenges-grid"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Trade Modal -->
<div class="modal fade" id="tradeModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title">Execute Trade</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="trade-form">
                    <div class="mb-3">
                        <label for="trade-symbol" class="form-label">Symbol</label>
                        <input type="text" class="form-control" id="trade-symbol" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="trade-action" class="form-label">Action</label>
                        <select class="form-select" id="trade-action">
                            <option value="buy">Buy</option>
                            <option value="sell">Sell</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="trade-quantity" class="form-label">Quantity</label>
                        <input type="number" class="form-control" id="trade-quantity" min="1" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Current Price</label>
                        <div class="form-control-plaintext" id="trade-current-price">-</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">AI Confidence</label>
                        <div class="form-control-plaintext" id="trade-confidence">-</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="executeTrade()">Execute Trade</button>
            </div>
        </div>
    </div>
</div>

<!-- Deposit Modal -->
<div class="modal fade" id="depositModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title">Deposit Funds</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="deposit-form">
                    <div class="mb-3">
                        <label for="deposit-amount" class="form-label">Deposit Amount</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" id="deposit-amount" min="1" step="0.01" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">
                            <i class="fas fa-lock me-1"></i>
                            Payments are processed securely through Stripe
                        </small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" onclick="processDeposit()" id="deposit-btn">
                    <i class="fas fa-credit-card me-2"></i>Proceed to Payment
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Buy Stock Modal -->
<div class="modal fade" id="buyModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title">Buy Stocks</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="buy-form">
                    <div class="mb-3">
                        <label for="buy-symbol-search" class="form-label">Search Stock Symbol</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="buy-symbol-search" 
                                   placeholder="Enter stock symbol (e.g., AAPL, MSFT, TSLA)" 
                                   style="text-transform: uppercase;">
                            <button type="button" class="btn btn-primary" onclick="searchStock()">
                                <i class="fas fa-search"></i> Search
                            </button>
                        </div>
                        <div class="form-text">Enter any valid stock ticker symbol to search</div>
                    </div>
                    
                    <!-- Stock info display after search -->
                    <div id="stock-search-result" style="display: none;">
                        <div class="alert alert-info mb-3">
                            <h6 class="mb-2" id="stock-info-name">-</h6>
                            <div class="row">
                                <div class="col-6">
                                    <small>Sector:</small> <span id="stock-info-sector">-</span>
                                </div>
                                <div class="col-6">
                                    <small>Market Cap:</small> <span id="stock-info-marketcap">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- AI Risk Analysis -->
                        <div class="mb-3" id="ai-risk-analysis" style="display: none;">
                            <h6 class="mb-2">AI Risk Analysis</h6>
                            <div class="alert alert-dark">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span>Risk Level:</span>
                                    <span class="badge" id="risk-level-badge">-</span>
                                </div>
                                <div class="mb-2">
                                    <strong>Key Risks:</strong>
                                    <ul class="mb-0 small" id="key-risks-list"></ul>
                                </div>
                                <div>
                                    <strong>Potential Rewards:</strong>
                                    <ul class="mb-0 small" id="potential-rewards-list"></ul>
                                </div>
                                <div class="mt-2 text-center">
                                    <span class="badge" id="ai-recommendation-badge">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="buy-quantity" class="form-label">Number of Shares to Buy</label>
                        <input type="number" class="form-control" id="buy-quantity" min="1" required>
                        <div class="form-text">Enter the number of shares you want to purchase</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Price per Share</label>
                        <div class="form-control-plaintext" id="buy-current-price">-</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Total Purchase Cost</label>
                        <div class="form-control-plaintext fw-bold text-warning" id="buy-total-cost">$0.00</div>
                        <div class="form-text" id="buy-purchase-summary" style="display: none;">
                            You are buying <span id="buy-shares-count">0</span> shares for <span id="buy-total-amount">$0.00</span>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Your Available Balance</label>
                        <div class="form-control-plaintext text-success" id="buy-available-balance">$0.00</div>
                        <div class="form-text text-danger" id="buy-insufficient-funds" style="display: none;">
                            Insufficient funds! Please deposit more money or reduce quantity.
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="executeBuy()" id="buy-btn">
                    <i class="fas fa-shopping-cart me-2"></i>Buy Stock
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Sell Stock Modal -->
<div class="modal fade" id="sellModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title">Sell Stocks</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="sell-form">
                    <div class="mb-3">
                        <label for="sell-symbol" class="form-label">Stock Symbol</label>
                        <select class="form-select" id="sell-symbol" required>
                            <option value="">Select a stock...</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="sell-quantity" class="form-label">Quantity</label>
                        <input type="number" class="form-control" id="sell-quantity" min="1" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Current Price</label>
                        <div class="form-control-plaintext" id="sell-current-price">-</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Total Proceeds</label>
                        <div class="form-control-plaintext" id="sell-total-proceeds">$0.00</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Shares Owned</label>
                        <div class="form-control-plaintext text-info" id="sell-shares-owned">0</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-warning" onclick="executeSell()" id="sell-btn">
                    <i class="fas fa-money-bill-wave me-2"></i>Sell Stock
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Transaction History Modal -->
<div class="modal fade" id="transactionModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title">Transaction History</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="transaction-history">
                    <div class="text-center text-muted">Loading transactions...</div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<!-- Custom JS for dashboard -->
<script src="{{ url_for('static', filename='js/notifications.js') }}?v={{ range(1000, 9999) | random }}"></script>
<script src="{{ url_for('static', filename='js/analytics.js') }}?v={{ range(1000, 9999) | random }}"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}?v={{ range(1000, 9999) | random }}"></script>
<script src="{{ url_for('static', filename='js/ai_assistant.js') }}?v={{ range(1000, 9999) | random }}"></script>
{% endblock %}
