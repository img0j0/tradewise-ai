<!DOCTYPE html>
<html>
<head>
    <title>Login Debug - Trading Analytics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #1a1a1a;
            color: #fff;
            padding: 20px;
        }
        .debug-card {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 20px;
        }
        .btn-primary {
            background-color: #00ff88;
            border-color: #00ff88;
            color: #000;
            font-weight: 600;
        }
        .btn-primary:hover {
            background-color: #00cc6a;
            border-color: #00cc6a;
        }
        #output {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">Login Debug Tool</h1>
        
        <div class="debug-card">
            <h3>Test 1: Basic Form Submit</h3>
            <form id="basicForm" action="/login" method="POST">
                <input type="hidden" name="username" value="trader1">
                <input type="hidden" name="password" value="TradingPro2025">
                <button type="submit" class="btn btn-primary">Submit Hidden Form</button>
            </form>
        </div>

        <div class="debug-card">
            <h3>Test 2: Manual Form</h3>
            <form id="manualForm" method="POST" action="/login">
                <div class="mb-3">
                    <input type="text" class="form-control" name="username" value="trader1" readonly>
                </div>
                <div class="mb-3">
                    <input type="password" class="form-control" name="password" value="TradingPro2025" readonly>
                </div>
                <button type="submit" class="btn btn-primary">Submit Manual Form</button>
            </form>
        </div>

        <div class="debug-card">
            <h3>Test 3: JavaScript Submit</h3>
            <button class="btn btn-primary" onclick="jsSubmit()">JavaScript Submit</button>
        </div>

        <div class="debug-card">
            <h3>Test 4: Direct Navigation</h3>
            <a href="/" class="btn btn-primary">Go to Dashboard</a>
            <a href="/debug-auth" class="btn btn-secondary ms-2">Check Auth Status</a>
        </div>

        <div class="debug-card">
            <h3>Debug Output</h3>
            <div id="output">Ready for testing...</div>
        </div>
    </div>

    <script>
        function log(msg) {
            const output = document.getElementById('output');
            output.textContent += msg + '\n';
            console.log(msg);
        }

        function jsSubmit() {
            log('Creating form data...');
            const formData = new FormData();
            formData.append('username', 'trader1');
            formData.append('password', 'TradingPro2025');
            
            log('Sending POST request...');
            fetch('/login', {
                method: 'POST',
                body: formData,
                credentials: 'same-origin'
            })
            .then(response => {
                log(`Response status: ${response.status}`);
                log(`Response redirected: ${response.redirected}`);
                if (response.redirected) {
                    log(`Redirect URL: ${response.url}`);
                    window.location.href = response.url;
                }
                return response.text();
            })
            .then(text => {
                log('Response received. Check if redirected.');
            })
            .catch(error => {
                log(`Error: ${error.message}`);
            });
        }

        // Check current auth status on load
        fetch('/debug-auth')
            .then(r => r.json())
            .then(data => {
                log(`Current auth status: ${JSON.stringify(data, null, 2)}`);
            })
            .catch(e => {
                log(`Auth check error: ${e.message}`);
            });
    </script>
</body>
</html>