<!DOCTYPE html>
<html>
<head>
    <title>Session Test - Trading Analytics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #1a1a1a;
            color: #fff;
            padding: 2rem;
        }
        .container {
            max-width: 800px;
        }
        pre {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Session Debug Page</h1>
        
        <div class="mb-4">
            <h3>Current Status:</h3>
            <pre id="status">Loading...</pre>
        </div>
        
        <div class="mb-4">
            <h3>Test Login:</h3>
            <button class="btn btn-primary" onclick="testLogin()">Test Login</button>
            <button class="btn btn-secondary" onclick="checkAuth()">Check Auth</button>
            <button class="btn btn-danger" onclick="testLogout()">Test Logout</button>
        </div>
        
        <div id="result"></div>
    </div>
    
    <script>
    async function checkAuth() {
        const response = await fetch('/debug-auth');
        const data = await response.json();
        document.getElementById('status').textContent = JSON.stringify(data, null, 2);
    }
    
    async function testLogin() {
        const formData = new FormData();
        formData.append('username', 'testuser');
        formData.append('password', 'password123');
        
        const response = await fetch('/login', {
            method: 'POST',
            body: formData,
            credentials: 'same-origin'
        });
        
        document.getElementById('result').innerHTML = `
            <div class="alert alert-info">
                Login response: ${response.status} ${response.statusText}<br>
                Redirected: ${response.redirected}<br>
                URL: ${response.url}
            </div>
        `;
        
        // Check auth after login
        setTimeout(checkAuth, 500);
    }
    
    async function testLogout() {
        const response = await fetch('/logout');
        document.getElementById('result').innerHTML = `
            <div class="alert alert-warning">
                Logout response: ${response.status} ${response.statusText}
            </div>
        `;
        
        // Check auth after logout
        setTimeout(checkAuth, 500);
    }
    
    // Check auth on load
    checkAuth();
    </script>
</body>
</html>