{% extends "base.html" %}

{% block title %}Monetization Dashboard{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <div class="card bg-dark text-white">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h2><i class="fas fa-chart-line text-success"></i> Monetization Dashboard</h2>
                    <button class="btn btn-outline-success" onclick="refreshMonetizationData()">
                        <i class="fas fa-sync-alt"></i> Refresh Data
                    </button>
                </div>
                <div class="card-body">
                    
                    <!-- Revenue Projection Cards -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body text-center">
                                    <h4><i class="fas fa-dollar-sign"></i></h4>
                                    <h3 id="monthly-revenue">Loading...</h3>
                                    <p>Monthly Revenue</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body text-center">
                                    <h4><i class="fas fa-users"></i></h4>
                                    <h3 id="user-count">Loading...</h3>
                                    <p>Active Users</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body text-center">
                                    <h4><i class="fas fa-exchange-alt"></i></h4>
                                    <h3 id="trade-count">Loading...</h3>
                                    <p>Total Trades</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-danger text-white">
                                <div class="card-body text-center">
                                    <h4><i class="fas fa-chart-bar"></i></h4>
                                    <h3 id="annual-projection">Loading...</h3>
                                    <p>Annual Projection</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Revenue Breakdown -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card bg-secondary">
                                <div class="card-header">
                                    <h5><i class="fas fa-pie-chart"></i> Revenue Breakdown</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-6">
                                            <p><strong>Trade Commissions:</strong></p>
                                            <p class="text-success h5" id="commission-revenue">$0</p>
                                        </div>
                                        <div class="col-6">
                                            <p><strong>Premium Features:</strong></p>
                                            <p class="text-info h5" id="premium-revenue">$0</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <p><strong>Referral Program:</strong></p>
                                            <p class="text-warning h5" id="referral-revenue">$0</p>
                                        </div>
                                        <div class="col-6">
                                            <p><strong>Commission Rate:</strong></p>
                                            <p class="text-muted">0.25% per trade</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card bg-secondary">
                                <div class="card-header">
                                    <h5><i class="fas fa-rocket"></i> Growth Scenarios</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-4">
                                            <p><strong>Conservative:</strong></p>
                                            <p class="text-success h6" id="conservative-growth">$0</p>
                                        </div>
                                        <div class="col-4">
                                            <p><strong>Moderate:</strong></p>
                                            <p class="text-info h6" id="moderate-growth">$0</p>
                                        </div>
                                        <div class="col-4">
                                            <p><strong>Aggressive:</strong></p>
                                            <p class="text-warning h6" id="aggressive-growth">$0</p>
                                        </div>
                                    </div>
                                    <div class="mt-3">
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 33%"></div>
                                            <div class="progress-bar bg-info" role="progressbar" style="width: 33%"></div>
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 34%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Premium Features -->
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card bg-secondary">
                                <div class="card-header">
                                    <h5><i class="fas fa-star"></i> Premium Features Available</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row" id="premium-features">
                                        <!-- Premium features will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Monetization Strategy -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card bg-primary text-white">
                                <div class="card-header">
                                    <h5><i class="fas fa-lightbulb"></i> Monetization Strategy Summary</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>âœ… Ethical Revenue Streams:</h6>
                                            <ul>
                                                <li>Low-cost trading commissions (0.25%)</li>
                                                <li>Optional premium features</li>
                                                <li>User-beneficial referral program</li>
                                                <li>Transparent payment for order flow</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>ðŸŽ¯ Key Benefits:</h6>
                                            <ul>
                                                <li>Platform remains free for all users</li>
                                                <li>Lowest commission rates in industry</li>
                                                <li>Users earn money through referrals</li>
                                                <li>Complete fee transparency</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="text-center mt-3">
                                        <a href="/monetization-info" class="btn btn-outline-light">
                                            <i class="fas fa-info-circle"></i> View Detailed Information
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Load monetization data
function loadMonetizationData() {
    // Load revenue projection
    fetch('/api/monetization/revenue-projection')
        .then(response => response.json())
        .then(data => {
            document.getElementById('monthly-revenue').textContent = 
                '$' + data.monthly_projections.total_monthly_revenue.toLocaleString();
            document.getElementById('user-count').textContent = data.user_count.toLocaleString();
            document.getElementById('trade-count').textContent = data.trade_count.toLocaleString();
            document.getElementById('annual-projection').textContent = 
                '$' + data.monthly_projections.annual_projection.toLocaleString();
                
            // Revenue breakdown
            document.getElementById('commission-revenue').textContent = 
                '$' + data.monthly_projections.trade_commissions.toLocaleString();
            document.getElementById('premium-revenue').textContent = 
                '$' + data.monthly_projections.premium_subscriptions.toLocaleString();
            document.getElementById('referral-revenue').textContent = 
                '$' + data.monthly_projections.referral_program.toLocaleString();
                
            // Growth scenarios
            document.getElementById('conservative-growth').textContent = 
                '$' + data.growth_scenarios.conservative.toLocaleString();
            document.getElementById('moderate-growth').textContent = 
                '$' + data.growth_scenarios.moderate.toLocaleString();
            document.getElementById('aggressive-growth').textContent = 
                '$' + data.growth_scenarios.aggressive.toLocaleString();
        })
        .catch(error => {
            console.error('Error loading revenue projection:', error);
            document.getElementById('monthly-revenue').textContent = 'Error';
        });
    
    // Load premium features
    fetch('/api/monetization/premium-features')
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('premium-features');
            container.innerHTML = '';
            
            Object.entries(data).forEach(([key, feature]) => {
                const featureHtml = `
                    <div class="col-md-6 mb-3">
                        <div class="card bg-dark border-success">
                            <div class="card-body">
                                <h6 class="text-success">${feature.name}</h6>
                                <p class="text-info h5">$${feature.price}/month</p>
                                <p class="small text-muted">${feature.description}</p>
                                <div class="mt-2">
                                    ${feature.features.map(f => `<small class="badge bg-secondary me-1">${f}</small>`).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += featureHtml;
            });
        })
        .catch(error => {
            console.error('Error loading premium features:', error);
        });
}

function refreshMonetizationData() {
    loadMonetizationData();
}

// Load data when page loads
document.addEventListener('DOMContentLoaded', loadMonetizationData);
</script>
{% endblock %}